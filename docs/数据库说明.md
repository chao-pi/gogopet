# 数据库相关说明

> 2025/04/23

## 数据库概述

GoGoPet 平台使用 MySQL 数据库，数据库名为 `gogopet`。本文档详细说明数据库表结构、字段定义、关系及索引设计。

## 用户相关表

### t_user（用户表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| user_id | VARCHAR(18) | 主键 | 用户ID，唯一标识符 |
| user_name | VARCHAR(63) | 非空 | 用户名称，用于登录和显示 |
| password | VARCHAR(63) | 非空 | 用户密码，加密存储 |
| user_type | CHAR(1) | 非空 | 用户类型：U-普通用户，C-托运公司，A-管理员 |
| user_address | VARCHAR(63) | 可空 | 用户地址，用于托运服务 |
| picture_id | VARCHAR(18) | 可空 | 用户头像ID，关联图片表 |
| company_id | VARCHAR(18) | 可空 | 公司ID，仅托运公司用户有值 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |
| update_time | DATETIME | 默认值 | 更新时间，自动更新 |

**索引**：
- 主键索引：user_id
- 普通索引：user_name, company_id

### t_company（托运公司表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| company_id | VARCHAR(18) | 主键 | 公司ID，唯一标识符 |
| company_intro | TEXT | 可空 | 公司介绍，详细描述公司情况 |
| company_local | VARCHAR(63) | 可空 | 公司地址，用于托运服务 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |
| update_time | DATETIME | 默认值 | 更新时间，自动更新 |

**索引**：
- 主键索引：company_id

## 宠物相关表

### t_pet（宠物表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| pet_id | VARCHAR(18) | 主键 | 宠物ID，唯一标识符 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示宠物主人 |
| pet_name | VARCHAR(63) | 非空 | 宠物名称 |
| pet_breed | VARCHAR(63) | 可空 | 宠物品种 |
| pet_weight | DECIMAL(5,2) | 可空 | 宠物体重，单位：千克 |
| pet_health_status | VARCHAR(255) | 可空 | 宠物健康状况描述 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |
| update_time | DATETIME | 默认值 | 更新时间，自动更新 |

**索引**：
- 主键索引：pet_id
- 外键索引：user_id
- 普通索引：user_id

## 订单相关表

### t_order（订单表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| order_id | VARCHAR(18) | 主键 | 订单ID，唯一标识符 |
| pet_id | VARCHAR(18) | 非空 | 宠物ID，关联宠物表 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示订单创建者 |
| company_id | VARCHAR(18) | 非空 | 公司ID，关联公司表，表示接单的托运公司 |
| order_status | CHAR(1) | 非空 | 订单状态：P-待支付，W-等待接单，T-运输中，C-已完成，X-已取消 |
| pet_status | CHAR(1) | 非空 | 宠物状态：N-正常，A-异常 |
| delivery_status | CHAR(1) | 非空 | 运输状态：P-等待接单，T-运输中，D-已送达 |
| start_time | DATETIME | 可空 | 托运开始时间 |
| end_time | DATETIME | 可空 | 托运结束时间 |
| start_location | VARCHAR(255) | 可空 | 起始地点 |
| end_location | VARCHAR(255) | 可空 | 目的地 |
| price | DECIMAL(10,2) | 非空 | 托运价格，单位：元 |
| payment_status | CHAR(1) | 非空 | 支付状态：U-未支付，P-已支付，R-已退款 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |
| update_time | DATETIME | 默认值 | 更新时间，自动更新 |

**索引**：
- 主键索引：order_id
- 外键索引：pet_id, user_id, company_id
- 普通索引：user_id, company_id, order_status

### t_order_tracking（订单追踪表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| tracking_id | VARCHAR(18) | 主键 | 追踪ID，唯一标识符 |
| order_id | VARCHAR(18) | 非空 | 订单ID，关联订单表 |
| location | VARCHAR(255) | 非空 | 当前位置 |
| status | CHAR(1) | 非空 | 状态：T-运输中，R-休息中 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |

**索引**：
- 主键索引：tracking_id
- 外键索引：order_id
- 普通索引：order_id, create_time

## 图片相关表

### t_picture（图片表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| picture_id | VARCHAR(18) | 主键 | 图片ID，唯一标识符 |
| picture_usage | VARCHAR(63) | 非空 | 图片用途：A-头像，P-宠物照片，O-其他照片 |
| picture_url | VARCHAR(255) | 非空 | 图片URL，存储图片的服务器路径 |
| upload_time | DATETIME | 默认值 | 上传时间，默认当前时间 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示上传者 |

**索引**：
- 主键索引：picture_id
- 外键索引：user_id
- 普通索引：user_id, picture_usage

## 社交相关表

### t_post（帖子表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| post_id | VARCHAR(18) | 主键 | 帖子ID，唯一标识符 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示发布者 |
| post_content | TEXT | 非空 | 帖子内容 |
| post_comment | INT | 默认值 | 评论数量，默认0 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |
| update_time | DATETIME | 默认值 | 更新时间，自动更新 |

**索引**：
- 主键索引：post_id
- 外键索引：user_id
- 普通索引：user_id

### t_comment（评论表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| comment_id | VARCHAR(18) | 主键 | 评论ID，唯一标识符 |
| company_id | VARCHAR(18) | 非空 | 公司ID，关联公司表，表示被评论的公司 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示评论者 |
| comment_content | TEXT | 非空 | 评论内容 |
| rating | TINYINT | 非空 | 评分，1-5分 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |

**索引**：
- 主键索引：comment_id
- 外键索引：company_id, user_id
- 普通索引：company_id, user_id

## 系统相关表

### t_system_log（系统日志表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| log_id | VARCHAR(18) | 主键 | 日志ID，唯一标识符 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示操作者 |
| operation_type | VARCHAR(63) | 非空 | 操作类型，如登录、修改信息等 |
| operation_content | TEXT | 可空 | 操作内容，详细记录操作信息 |
| operation_time | DATETIME | 默认值 | 操作时间，默认当前时间 |

**索引**：
- 主键索引：log_id
- 外键索引：user_id
- 普通索引：user_id, operation_time

### t_notification（消息通知表）

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| notification_id | VARCHAR(18) | 主键 | 通知ID，唯一标识符 |
| user_id | VARCHAR(18) | 非空 | 用户ID，关联用户表，表示接收者 |
| notification_type | VARCHAR(63) | 非空 | 通知类型：O-订单，S-系统 |
| notification_content | TEXT | 非空 | 通知内容 |
| is_read | BOOLEAN | 默认值 | 是否已读，0-未读，1-已读，默认未读 |
| create_time | DATETIME | 默认值 | 创建时间，默认当前时间 |

**索引**：
- 主键索引：notification_id
- 外键索引：user_id
- 普通索引：user_id, is_read

## 表关系说明

- 一个用户可以拥有多个宠物（一对多）
- 一个用户可以创建多个订单（一对多）
- 一个托运公司可以处理多个订单（一对多）
- 一个用户可以发布多个帖子（一对多）
- 一个用户可以发表多个评论（一对多）
- 一个托运公司可以收到多个评论（一对多）
- 一个订单可以有多个追踪记录（一对多）
- 一个用户可以上传多张图片（一对多）
- 一个用户可以接收多个通知（一对多）

## 字段类型说明

- ID字段：使用VARCHAR(18)，便于存储UUID或自定义ID
- 状态字段：使用CHAR(1)，节省存储空间
- 时间字段：使用DATETIME，包含日期和时间信息
- 文本字段：根据长度使用VARCHAR或TEXT
- 数值字段：根据范围使用INT、TINYINT或DECIMAL
- 布尔字段：使用BOOLEAN，表示是/否状态

## 索引设计原则

- 主键索引：所有表的主键字段
- 外键索引：所有外键字段
- 常用查询字段：如user_name, order_status等
- 时间字段：如create_time, operation_time等
- 状态字段：如is_read, order_status等