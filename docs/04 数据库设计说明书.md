# 数据库结构设计

《宠物托运智能服务系统》数据库结构设计

2025年3月26日

## 1 总体需求分析

随着我国城市化进程的加快和独居人群的增加，宠物已成为许多家庭的重要伴侣。宠物经济迎来快速增长，宠物托运行业也逐渐受到市场关注。

目前市场存在的问题有：

· 跨城市迁移和旅行需求增加，导致宠物托运需求大幅上升。

· 传统托运方式存在痛点，如信息不透明、服务不规范、宠物安全性无法保障等问题。

· 数字化管理水平低，目前市场上缺乏智能化托运管理系统，导致运营效率较低。

## 2 数据库概要设计
根据总体需求分析，绘制数据库的实体关系模型（E-R图）如下：

![](https://cdn.nlark.com/yuque/0/2025/png/40615927/1745302443078-859a23a8-a82c-41cb-a471-428ba2ad550f.png)

图 1 系统E-R图

## 3 数据库表详细设计
### 3.1 标识符规范
数据库使用MySQL。命名规则（如下开头）：

· 表：t_

· 视图：v_

· 存储过程：sp_

### 3.2 数据对象
#### 3.2.1 数据表（总体介绍）
| <font style="color:rgb(0, 0, 0);">表名</font> | <font style="color:rgb(0, 0, 0);">实体名称</font> | <font style="color:rgb(0, 0, 0);">主键</font> | <font style="color:rgb(0, 0, 0);">备注</font> |
| --- | --- | --- | :---: |
| <font style="color:rgb(0, 0, 0);">t_user</font> | <font style="color:rgb(0, 0, 0);">用户表</font> | <font style="color:rgb(0, 0, 0);">用户ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_pet</font> | <font style="color:rgb(0, 0, 0);">宠物表</font> | <font style="color:rgb(0, 0, 0);">宠物ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_picture</font> | <font style="color:rgb(0, 0, 0);">图片表</font> | <font style="color:rgb(0, 0, 0);">图片ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_order</font> | <font style="color:rgb(0, 0, 0);">订单表</font> | <font style="color:rgb(0, 0, 0);">订单ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_chat</font> | <font style="color:rgb(0, 0, 0);">对话表</font> | <font style="color:rgb(0, 0, 0);">会话ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_post</font> | <font style="color:rgb(0, 0, 0);">推文表</font> | <font style="color:rgb(0, 0, 0);">推文ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_company</font> | <font style="color:rgb(0, 0, 0);">公司表</font> | <font style="color:rgb(0, 0, 0);">公司ID</font> | |
| <font style="color:rgb(0, 0, 0);">t_comment</font> | <font style="color:rgb(0, 0, 0);">评论表</font> | <font style="color:rgb(0, 0, 0);">评论ID</font> | |


#### 3.2.2 用户表（t_user）
| <font style="color:#000000;">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">用户ID</font> | <font style="color:rgb(0, 0, 0);">user_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">用户名</font> | <font style="color:rgb(0, 0, 0);">user_name</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(63)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">注册信息</font> |
| <font style="color:rgb(0, 0, 0);">密码</font> | <font style="color:rgb(0, 0, 0);">password</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(63)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">注册信息</font> |
| <font style="color:rgb(0, 0, 0);">用户身份</font> | <font style="color:rgb(0, 0, 0);">user_type</font> | <font style="color:rgb(0, 0, 0);">CHAR(1)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">类型（用户/托运司机/管理员/……）</font> |
| <font style="color:rgb(0, 0, 0);">用户地址</font> | <font style="color:rgb(0, 0, 0);">user_address</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(63)</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">用户地址，限于用户、司机填写</font> |
| <font style="color:rgb(0, 0, 0);">用户头像</font> | <font style="color:rgb(0, 0, 0);">picture_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">外键，指明用户头像</font> |
| <font style="color:rgb(0, 0, 0);">公司ID</font> | <font style="color:rgb(0, 0, 0);">company_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">外键，如果身份为司机则指明公司</font> |


#### 3.2.3 宠物表（t_pet）
| <font style="color:#000000;">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">宠物ID</font> | <font style="color:rgb(0, 0, 0);">pet_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">用户ID</font> | <font style="color:rgb(0, 0, 0);">user_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明其主人</font> |
| <font style="color:rgb(0, 0, 0);">宠物名称</font> | <font style="color:rgb(0, 0, 0);">pet_name</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(63)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">宠物信息</font> |
| <font style="color:rgb(0, 0, 0);">宠物品种</font> | <font style="color:rgb(0, 0, 0);">pet_breed</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(63)</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">宠物信息</font> |
| <font style="color:rgb(0, 0, 0);">宠物体重</font> | <font style="color:rgb(0, 0, 0);">pet_weight</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">宠物信息</font> |
| <font style="color:rgb(0, 0, 0);">宠物健康状态</font> | <font style="color:rgb(0, 0, 0);">pet_health_status</font> | <font style="color:rgb(0, 0, 0);">CHAR(1)</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">宠物信息</font> |


#### 3.2.4 图片表（t_picture）
| <font style="color:#000000;">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">图片ID</font> | <font style="color:rgb(0, 0, 0);">picture_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">图片用途</font> | <font style="color:rgb(0, 0, 0);">picture_usage</font> | <font style="color:rgb(0, 0, 0);">CHAR(1)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">标识其用途，包括（推文/图像识别/……），避免id重复时导致冲突</font> |


#### 3.2.5 订单表（t_order）
| <font style="color:rgb(0, 0, 0);">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">订单ID</font> | <font style="color:rgb(0, 0, 0);">order_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">宠物ID</font> | <font style="color:rgb(0, 0, 0);">pet_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明该订单涉及的宠物</font> |
| <font style="color:rgb(0, 0, 0);">图片ID</font> | <font style="color:rgb(0, 0, 0);">picture_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明该订单包含的宠物图片</font> |
| <font style="color:rgb(0, 0, 0);">订单状态</font> | <font style="color:rgb(0, 0, 0);">order_status</font> | <font style="color:rgb(0, 0, 0);">CHAR(1)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">指明订单目前的状态（未指派/托运中/已完成/已取消/……）</font> |
| <font style="color:rgb(0, 0, 0);">宠物当前状态</font> | <font style="color:rgb(0, 0, 0);">pet_status</font> | <font style="color:rgb(0, 0, 0);">CHAR(1)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">用于实时反馈当前托运宠物的状态，包括（健康/生病/……）</font> |
| <font style="color:rgb(0, 0, 0);">运输状态</font> | <font style="color:rgb(0, 0, 0);">delivery_status</font> | <font style="color:rgb(0, 0, 0);">CHAR(1)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">指明当前托运司机的运输进度</font> |


#### 3.2.6 对话表（t_chat）
| <font style="color:rgb(0, 0, 0);">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">对话ID</font> | <font style="color:rgb(0, 0, 0);">chat_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">用户ID</font> | <font style="color:rgb(0, 0, 0);">pet_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明该会话主体为哪个客户</font> |
| <font style="color:rgb(0, 0, 0);">对话内容</font> | <font style="color:rgb(0, 0, 0);">chat_content</font> | <font style="color:rgb(0, 0, 0);">LONGTEXT</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">储存会话</font> |


#### 3.2.7 推文表（t_post）
| <font style="color:rgb(0, 0, 0);">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">推文ID</font> | <font style="color:rgb(0, 0, 0);">post_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">用户ID</font> | <font style="color:rgb(0, 0, 0);">pet_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明当前推文的发布者</font> |
| <font style="color:rgb(0, 0, 0);">推文内容</font> | <font style="color:rgb(0, 0, 0);">post_content</font> | <font style="color:rgb(0, 0, 0);">LONGTEXT</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">指明当前推文的内容</font> |
| <font style="color:rgb(0, 0, 0);">推文评论</font> | <font style="color:rgb(0, 0, 0);">post_comment</font> | <font style="color:rgb(0, 0, 0);">LONGTEXT</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">储存评论</font> |


#### 3.2.8 公司表（t_company）
| <font style="color:#000000;">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">公司ID</font> | <font style="color:rgb(0, 0, 0);">company_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">公司介绍</font> | <font style="color:rgb(0, 0, 0);">company_intro</font> | <font style="color:rgb(0, 0, 0);">LONGTEXT</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">公司信息</font> |
| <font style="color:rgb(0, 0, 0);">公司地址</font> | <font style="color:rgb(0, 0, 0);">company_local</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(63)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">公司信息</font> |


#### 3.2.9 评价表（t_comment）


| <font style="color:rgb(0, 0, 0);">属性</font> | <font style="color:rgb(0, 0, 0);">字段名</font> | <font style="color:rgb(0, 0, 0);">数据类型</font> | <font style="color:rgb(0, 0, 0);">允许空值</font> | <font style="color:rgb(0, 0, 0);">说明</font> |
| --- | --- | --- | --- | --- |
| <font style="color:rgb(0, 0, 0);">评价ID</font> | <font style="color:rgb(0, 0, 0);">comment_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">主键，唯一标识符</font> |
| <font style="color:rgb(0, 0, 0);">公司ID</font> | <font style="color:rgb(0, 0, 0);">company_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明评论的对象</font> |
| <font style="color:rgb(0, 0, 0);">用户ID</font> | <font style="color:rgb(0, 0, 0);">user_id</font> | <font style="color:rgb(0, 0, 0);">VARCHAR(18)</font> | <font style="color:rgb(0, 0, 0);">N</font> | <font style="color:rgb(0, 0, 0);">外键，指明评论的发布者</font> |
| <font style="color:rgb(0, 0, 0);">评论内容</font> | <font style="color:rgb(0, 0, 0);">comment_content</font> | <font style="color:rgb(0, 0, 0);">LONGTEXT</font> | <font style="color:rgb(0, 0, 0);">Y</font> | <font style="color:rgb(0, 0, 0);">指明当前评论的内容</font> |


## 4 SQL语句
create schema PetGoGO;

use PetGoGO;



CREATE TABLE t_user (

    user_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '用户ID，唯一标识符',
    
    user_name VARCHAR(63) NOT NULL COMMENT '用户名，注册信息',
    
    password VARCHAR(63) NOT NULL COMMENT '密码，注册信息',
    
    user_type CHAR(1) NOT NULL COMMENT '用户身份，类型（用户/托运司机/管理员/……）',
    
    user_address VARCHAR(63) NULL COMMENT '用户地址，限于用户、司机填写',
    
    picture_id VARCHAR(18) NULL COMMENT '用户头像，外键，指明用户头像',
    
    company_id VARCHAR(18) NULL COMMENT '公司ID，外键，如果身份为司机则指明公司',
    
    FOREIGN KEY (picture_id) REFERENCES t_picture(picture_id),
    
    FOREIGN KEY (company_id) REFERENCES t_company(company_id)

);



CREATE TABLE t_pet (

    pet_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '宠物ID，唯一标识符',
    
    user_id VARCHAR(18) NOT NULL COMMENT '用户ID，外键，指明其主人',
    
    pet_name VARCHAR(63) NOT NULL COMMENT '宠物名称',
    
    pet_breed VARCHAR(63) NULL COMMENT '宠物品种',
    
    pet_weight VARCHAR(18) NULL COMMENT '宠物体重',
    
    pet_health_status CHAR(1) NULL COMMENT '宠物健康状态',
    
    FOREIGN KEY (user_id) REFERENCES t_user(user_id)

);



CREATE TABLE t_picture (

    picture_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '图片ID，唯一标识符',
    
    picture_usage CHAR(1) NOT NULL COMMENT '图片用途，包括（推文/图像识别/……）'

);



CREATE TABLE t_order (

    order_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '订单ID，唯一标识符',
    
    pet_id VARCHAR(18) NOT NULL COMMENT '宠物ID，外键，指明该订单涉及的宠物',
    
    picture_id VARCHAR(18) NOT NULL COMMENT '图片ID，外键，指明该订单包含的宠物图片',
    
    order_status CHAR(1) NOT NULL COMMENT '订单状态（未指派/托运中/已完成/已取消/……）',
    
    pet_status CHAR(1) NOT NULL COMMENT '宠物当前状态（健康/生病/……）',
    
    delivery_status CHAR(1) NOT NULL COMMENT '运输状态，指明当前托运司机的运输进度',
    
    FOREIGN KEY (pet_id) REFERENCES t_pet(pet_id),
    
    FOREIGN KEY (picture_id) REFERENCES t_picture(picture_id)

);



CREATE TABLE t_chat (

    chat_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '对话ID，唯一标识符',
    
    user_id VARCHAR(18) NOT NULL COMMENT '用户ID，外键，指明该会话主体为哪个客户',
    
    chat_content LONGTEXT NULL COMMENT '储存会话',
    
    FOREIGN KEY (user_id) REFERENCES t_user(user_id)

);



CREATE TABLE t_post (

    post_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '推文ID，唯一标识符',
    
    user_id VARCHAR(18) NOT NULL COMMENT '用户ID，外键，指明当前推文的发布者',
    
    post_content LONGTEXT NULL COMMENT '推文内容',
    
    post_comment LONGTEXT NULL COMMENT '推文评论',
    
    FOREIGN KEY (user_id) REFERENCES t_user(user_id)

);



CREATE TABLE t_company (

    company_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '公司ID，唯一标识符',
    
    company_intro LONGTEXT NOT NULL COMMENT '公司介绍',
    
    company_local VARCHAR(63) NOT NULL COMMENT '公司地址'

);



CREATE TABLE t_comment (

    comment_id VARCHAR(18) NOT NULL PRIMARY KEY COMMENT '评价ID，唯一标识符',
    
    company_id VARCHAR(18) NOT NULL COMMENT '公司ID，外键，指明评论的对象',
    
    user_id VARCHAR(18) NOT NULL COMMENT '用户ID，外键，指明评论的发布者',
    
    comment_content LONGTEXT NULL COMMENT '评论内容',
    
    FOREIGN KEY (company_id) REFERENCES t_company(company_id),
    
    FOREIGN KEY (user_id) REFERENCES t_user(user_id)

);



